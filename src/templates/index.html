{% extends "layout.html" %}

{% block title %}
Reference app
{% endblock %}

{% block body %}

<h2>Reference app</h2>

<ul>
  {% for reference in references %}
    <script>
        function showConfirmation(event) {
            event.preventDefault();

            if (confirm("Confrim deletion of reference")) {
                event.target.submit();}
            }
    </script>
    <li style="display: flex">
      <div>
        {{ reference }} 
        <form action="/delete_ref" method="post" onsubmit="showConfirmation(event)" >
          <input type="hidden" name="reference_id" value="{{ reference.id }}">
          <button type="submit">Delete reference</button>
        </form>
        <form action="/edit" method="get">
        <input type="hidden" name="reference_id" value="{{ reference.id }}">
        <button type="submit">Edit reference</button>
        </form>
      </div>
    </li>
  {% endfor %}
</ul>
<p>
  <label for="reference_type">Reference type:</label><br />
  <select name="reference_type" id="reference_type" required>
    <option value="">(valitse)</option>
    <option value="article">@article</option>
    <option value="book">@book</option>
    <option value="booklet">@booklet</option>
    <option value="conference">@conference</option>
    <option value="inbook">@inbook</option>
    <option value="incollection">@incollection</option>
    <option value="inproceedings">@inproceedings</option>
    <option value="manual">@manual</option>
    <option value="mastersthesis">@mastersthesis</option>
    <option value="phdthesis">@phdthesis</option>
    <option value="proceedings">@proceedings</option>
    <option value="techreport">@techreport</option>
    <option value="unpublished">@unpublished</option>
  </select>
</p>
<form action="/new_reference" method="get" onsubmit="return validateReferenceType()">
  <input type="hidden" name="reference_type" id="selected_reference_type">
  <button type="submit">Create new reference</button>
</form>

<script>
  function validateReferenceType() {
    const select = document.getElementById('reference_type');
    const selectedValue = select.value;
    
    if (!selectedValue) {
      alert('Please select a reference type before creating a new reference.');
      return false;
    }
    
    document.getElementById('selected_reference_type').value = selectedValue;
    return true;
  }
</script>

{% endblock %}